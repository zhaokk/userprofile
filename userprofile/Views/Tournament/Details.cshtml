@model userprofile.Models.TOURNAMENT
@{
    ViewBag.Title = "Details";
}

<div class="row">
    <div class="col-md-12">
        <div class="box">
            <div class="box-body">
                <div>
                    
                    @{
                        //check if this user is an organizer for the tournament
                        foreach (var org in Model.AspNetUsers)
                        {
                            if (User.Identity.Name == org.UserName)
                            {
                                @Html.ActionLink("Edit", "Edit", new { id = Model.tournamentId }, new { @class = "btn btn-warning pull-right" })
                            }
                        }

                        //admin is god
                        if (User.IsInRole("Admin"))
                        {
                            @Html.ActionLink("Edit", "Edit", new { id = Model.tournamentId }, new { @class = "btn btn-warning pull-right" })
                            @Html.ActionLink("Delete", "Delete", new { id = Model.tournamentId }, new { @class = "btn btn-danger pull-right" })
                        }
                    }
                    <h4>TOURNAMENT</h4>
                    <hr />
                    <dl class="dl-horizontal">
                        <dt>
                           Name
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.name)
                        </dd>
                        <dt>
                            Start Date
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.startDate)
                        </dd>
                        <dt>
                            Age Bracket
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.ageBracket)
                        </dd>
                        <dt>
                            Grade
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.grade)
                        </dd>
                        <dt>
                            Status
                        </dt>
                        <dd>
                            @switch (Model.status) {
								case 0:
									@:Cancelled
									break;
								case 1:
									if (Model.startDate > DateTime.Now) {
										@:Not Started
									}
									else {
										@:In Progress
									}
									break;
								case 2:
									@: Completed
									break;
								default:
									@:ERROR!
									break;
							}
                        </dd>
						@if (User.IsInRole("Admin") || User.IsInRole("Assignor")) {
							<dt>
								Priority
							</dt>
							<dd>
								@Html.DisplayFor(model => model.priority)
							</dd>
						}
                        <dt>
                            Tournament Organizer
                        </dt>
                        <dd>
							<a href="@Url.Action( "Details","Account", new { id = Model.AspNetUser.UserName })">
								@Model.AspNetUser.firstName
								@Model.AspNetUser.lastName
								(@Model.AspNetUser.UserName)
							</a>
						</dd>
                        <dt>
                            Sport
                        </dt>
                        <dd>
                            @Html.DisplayFor(model => model.SPORT1.name)
                        </dd>
                    </dl>
                </div>
                <p>
                    
                    @Html.ActionLink("List of tournaments", "Index")
                </p>
            </div>
        </div>
    </div>
</div>